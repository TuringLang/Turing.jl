<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Inference · Turing</title><meta name="title" content="Inference · Turing"/><meta property="og:title" content="Inference · Turing"/><meta property="twitter:title" content="Inference · Turing"/><meta name="description" content="Documentation for Turing."/><meta property="og:description" content="Documentation for Turing."/><meta property="twitter:description" content="Documentation for Turing."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body>
<!-- NAVBAR START -->
<style>
    @import url('https://fonts.googleapis.com/css2?family=Source+Sans+Pro&display=swap');

    /* Documenter.jl CSS Overrides */
    html {
        scroll-padding-top: calc(var(--navbar-height) + 1rem);
    }
    .docs-sidebar, #documenter {
        margin-top: var(--navbar-height);
    }
    .docs-version-selector {
        margin-bottom: 60px !important;
    }
    @media screen and (max-width: 1056px) {
        .docs-version-selector {
            margin-bottom: 60px !important;
        }
        .docs-sidebar {
            margin-top: 0 !important;
        }
    }
    /* End of Documenter.jl Tweaks */

    /* Color and Font Variables */
    :root {
        --heading-color: #6c757d;
        --item-color: rgb(165, 165, 165);
        --primary-bg: white;
        --hover-color: #8faad2;
        --deprecated-bg: #ff4d4d;
        --deprecated-text: white;
        --icon-color: #6c757d;
        --shadow-color: rgba(0, 0, 0, 0.1);
        --dropdown-hover-bg: #e9ecef;
        
        /* Typography */
        --font-family: "Source Sans Pro", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        --nav-link-font-size: 1.0625rem;
        --turing-title-font-size: 21.25px;
        --icon-font-size: 1.25rem;
        --dropdown-arrow-font-size: 0.6875rem;
        --badge-font-size: 0.75rem;

        /* Sizing and Spacing */
        --navbar-height: 3.75rem;
        --logo-height: 31.18px;
        --logo-width: 52.47px;
        --logo-padding-top: 7px;
        --logo-margin-left: 0.3rem;
        --title-margin-left: 0.4px;
        --title-nav-spacing: 1.7rem;
        --nav-item-margin-left: 1.3rem;
        --icon-margin-left: 1rem;
        --dropdown-padding: 1.875rem;
        --dropdown-item-width: 12.5rem;
        --dropdown-subitem-width: 15.625rem;
        --dropdown-subitem-padding: 0.125rem 0.625rem;
    }

    /* Dark Theme Variable Overrides */
    html.theme--documenter-dark {
        --heading-color: #e0e0e0;
        --item-color: #bdbdbd;
        --primary-bg: #1f2424;
        --hover-color: #ffffff;
        --icon-color: #e0e0e0;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #424242;
    }

    /* Catppuccin Theme Overrides */
    html.theme--catppuccin-latte {
        --heading-color: #4c4f69;
        --primary-bg: #eff1f5;
        --icon-color: #4c4f69;
        --shadow-color: rgba(0, 0, 0, 0.1);
        --dropdown-hover-bg: #e6e9ef;
    }
    html.theme--catppuccin-frappe {
        --heading-color: #c6d0f5;
        --primary-bg: #303446;
        --icon-color: #c6d0f5;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #51576d;
    }
    html.theme--catppuccin-macchiato {
        --heading-color: #cad3f5;
        --primary-bg: #24273a;
        --icon-color: #cad3f5;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #494d64;
    }
    html.theme--catppuccin-mocha {
        --heading-color: #cad3f5;
        --primary-bg: #1e1e2e;
        --icon-color: #cad3f5;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #45475a;
    }


    /* Main Navigation Bar */
    .ext-navigation {
        font-family: var(--font-family);
        position: fixed;
        height: var(--navbar-height);
        top: 0;
        width: 100%;
        background-color: var(--primary-bg);
        z-index: 1000;
        box-shadow: 0 2px 4px var(--shadow-color);
        display: flex;
        align-items: center;
        padding: 0 1.0625rem;
        transition: transform 0.3s, background-color 0.3s;
    }

    nav.ext-navigation .ext-navbar-logo {
        margin-left: var(--logo-margin-left);
        height: var(--logo-height);
        width: var(--logo-width);
        padding-top: var(--logo-padding-top);
    }
    
    .ext-navbar-title {
        color: var(--heading-color) !important;
        font-size: var(--turing-title-font-size) !important;
        margin-left: var(--title-margin-left);
        text-decoration: none;
        transition: color 0.2s ease;
    }
    
    .ext-navbar-title:hover {
        color: var(--hover-color) !important;
    }

    .ext-nav-links {
        display: flex;
        align-items: center;
        list-style-type: none;
        margin: 0;
        padding: 0;
        flex-grow: 1;
        margin-left: var(--title-nav-spacing);
    }

    .ext-nav-links li:first-child {
        margin-left: 0 !important;
    }

    .ext-nav-links li {
        margin-left: var(--nav-item-margin-left) !important;
    }

    .ext-nav-link {
        color: var(--heading-color) !important;
        text-decoration: none;
        font-size: var(--nav-link-font-size) !important;
        transition: color 0.2s ease;
        cursor: pointer;
    }

    .ext-nav-link:hover,
    .ext-navbar-item-single a:hover,
    .ext-navbar-icons a:hover {
        color: var(--hover-color) !important;
    }

    .ext-navbar-item-single a {
        color: var(--heading-color) !important;
    }
    
    .ext-navbar-icons {
        display: flex;
        align-items: center;
    }

    .ext-navbar-icons a {
        color: var(--icon-color) !important;
        font-size: var(--icon-font-size) !important;
        transition: color 0.2s ease;
        margin-left: var(--icon-margin-left);
    }

    .ext-menu-toggle {
        display: none;
        font-size: 1.5rem;
        color: var(--heading-color);
        cursor: pointer;
    }

    .ext-dropdown {
        display: none;
        grid-template-columns: 1fr 1fr 1fr 1fr;
        padding: var(--dropdown-padding);
        position: absolute;
        top: var(--navbar-height);
        width: 100%;
        left: 0;
        background-color: var(--primary-bg);
        line-height: 1.875rem;
        opacity: 0;
        transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out, background-color 0.3s;
        transform: translateY(-0.625rem);
        box-shadow: 0 4px 6px var(--shadow-color);
    }

    #library-handler::after {
        content: "▼";
        font-size: var(--dropdown-arrow-font-size);
        margin-left: 0.3125rem;
        transition: transform 0.3s ease-in-out;
    }

    #library-handler.open::after {
        content: "▲";
    }

    .ext-dropdown.show {
        display: grid;
        opacity: 1;
        transform: translateY(0);
    }

    .ext-dropdown ul {
        width: var(--dropdown-item-width);
        margin-bottom: 1.25rem;
    }

    .ext-dropdown ul li {
        text-align: left;
        display: flex;
        align-items: center;
    }

    .ext-dropdown ul a li {
        color: var(--item-color);
        width: var(--dropdown-subitem-width);
        border-radius: 3px;
        padding: var(--dropdown-subitem-padding);
        transition: background-color 0.2s ease;
    }

    .ext-dropdown ul a li:hover {
        background-color: var(--dropdown-hover-bg);
    }

    .ext-dropdown-item-heading {
        color: var(--heading-color);
        text-align: center;
    }

    .deprecated-badge {
        background-color: var(--deprecated-bg);
        color: var(--deprecated-text);
        font-size: var(--badge-font-size);
        padding: .1rem;
        border-radius: 3px;
        margin-left: 0.5rem;
        line-height: 1;
    }

    @media (max-width: 966px) {
        .ext-dropdown {
            grid-template-columns: 1fr 1fr 1fr;
        }
    }

    @media (max-width: 768px) {
        .ext-nav-links {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
            background-color: var(--primary-bg);
            position: absolute;
            top: var(--navbar-height);
            left: 0;
            padding: 0.625rem 0;
            height: auto;
            overflow-y: auto;
            box-shadow: 0 4px 6px var(--shadow-color);
            margin-left: 0;
        }

        .ext-nav-links.show {
            display: flex;
        }

        .ext-nav-links li {
            margin: 0.625rem 0 !important;
            text-align: center;
        }
        
        .ext-menu-toggle {
            display: block;
            margin-left: auto;
        }

        .ext-navigation.hide {
            transform: translateY(calc(-1 * var(--navbar-height)));
        }

        .ext-dropdown {
            position: static;
            display: block;
            opacity: 1;
            transform: none;
            box-shadow: none;
            grid-template-columns: 1fr;
            padding: 0.625rem;
            text-align: center;
        }

        .ext-dropdown ul {
            width: auto;
            display: inline-block;
            margin: 0 auto 0.3125rem;
            text-align: left;
        }
    }
</style>
<nav class="ext-navigation">
    <a href="https://turinglang.org/">
        <img src="https://turinglang.org/assets/images/turing-logo.svg" alt="Turing Logo" class="ext-navbar-logo">
    </a>
    <a class="ext-navbar-title" href="https://turinglang.org/">Turing.jl</a>
    
    <ul class="ext-nav-links">
        <li><a class="ext-nav-link" href="https://turinglang.org/docs/tutorials/docs-00-getting-started/">Get Started</a></li>
        <li><a class="ext-nav-link" href="https://turinglang.org/docs/tutorials/00-introduction/">Tutorials</a></li>
        <li><a class="ext-nav-link" href="https://turinglang.org/docs/faq/">FAQ</a></li>
        <li>
            <p class="ext-nav-link" id="library-handler">Libraries</p>
            <div class="ext-dropdown" id="ext-dropdown-items">
                <ul>
                    <li class="ext-dropdown-item-heading">Modelling Languages</li>
                    <a href="https://turinglang.org/DynamicPPL.jl/"><li>DynamicPPL</li></a>
                    <a href="https://turinglang.org/JuliaBUGS.jl/"><li>JuliaBUGS</li></a>
                    <a href="https://turinglang.org/TuringGLM.jl/"><li>TuringGLM</li></a>
                </ul>
                <ul>
                    <li class="ext-dropdown-item-heading">MCMC</li>
                    <a href="https://turinglang.org/AdvancedHMC.jl/"><li>AdvancedHMC</li></a>
                    <a href="https://turinglang.org/AbstractMCMC.jl/"><li>AbstractMCMC</li></a>
                    <a href="https://github.com/theogf/ThermodynamicIntegration.jl"><li>ThermodynamicIntegration</li></a>
                    <a href="https://turinglang.org/AdvancedPS.jl/"><li>AdvancedPS</li></a>
                    <a href="https://turinglang.org/SliceSampling.jl/"><li>SliceSampling</li></a>
                    <a href="https://turinglang.org/EllipticalSliceSampling.jl/"><li>EllipticalSliceSampling</li></a>
                    <a href="https://turinglang.org/NestedSamplers.jl/"><li>NestedSamplers</li></a>
                </ul>
                <ul>
                    <li class="ext-dropdown-item-heading">Diagnostics</li>
                    <a href="https://turinglang.org/MCMCChains.jl/"><li>MCMCChains</li></a>
                    <a href="https://turinglang.org/MCMCDiagnosticTools.jl/"><li>MCMCDiagnosticTools</li></a>
                    <a href="https://turinglang.org/ParetoSmooth.jl/"><li>ParetoSmooth</li></a>
                </ul>
                <ul>
                    <li class="ext-dropdown-item-heading">Gaussian Processes</li>
                    <a href="https://juliagaussianprocesses.github.io/AbstractGPs.jl/"><li>AbstractGPs</li></a>
                    <a href="https://juliagaussianprocesses.github.io/KernelFunctions.jl/"><li>KernelFunctions</li></a>
                    <a href="https://juliagaussianprocesses.github.io/ApproximateGPs.jl/"><li>ApproximateGPs</li></a>
                </ul>
                <ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/Bijectors.jl/">Bijectors</a></li></ul>
                <ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/TuringCallbacks.jl/">TuringCallbacks</a></li></ul>
                <ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/Deprecated/TuringBenchmarking/">TuringBenchmarking</a><span class="deprecated-badge">Deprecated</span></li></ul>
            </div>
        </li>
        <li><a class="ext-nav-link" href="https://turinglang.org/news/">News</a></li>
        <li><a class="ext-nav-link" href="https://turinglang.org/team/">Team</a></li>
    </ul>

    <div class="ext-navbar-icons">
        <a href="https://x.com/TuringLang" aria-label="Turing on X"><i class="fa-brands fa-x-twitter"></i></a>
        <a href="https://discourse.julialang.org/c/domain/probprog/48" aria-label="Turing on Discourse"><i class="fa-brands fa-discourse"></i></a>
        <a href="https://julialang.slack.com/archives/CCYDC34A0" aria-label="Turing on Slack"><i class="fa-brands fa-slack"></i></a>
        <a href="https://github.com/TuringLang/" aria-label="Turing.jl on GitHub"><i class="fa-brands fa-github"></i></a>
    </div>

    <span class="ext-menu-toggle"><i class="fa-solid fa-bars"></i></span>
</nav>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const menuToggle = document.querySelector(".ext-menu-toggle");
        const navLinks = document.querySelector(".ext-nav-links");
        const nav = document.querySelector(".ext-navigation");
        const libraryHandler = document.getElementById("library-handler");
        const dropdownContainer = document.getElementById("ext-dropdown-items");
        let lastScrollY = window.scrollY;

        function closeDropdown() {
            if (dropdownContainer.classList.contains("show")) {
                libraryHandler.classList.remove("open");
                dropdownContainer.classList.remove("show");
                setTimeout(() => {
                    if (!dropdownContainer.classList.contains("show")) {
                        dropdownContainer.style.display = "none";
                    }
                }, 300);
            }
        }

        function openDropdown() {
            dropdownContainer.style.display = "grid";
            libraryHandler.classList.add("open");
            setTimeout(() => {
                dropdownContainer.classList.add("show");
            }, 10);
        }

        function setAppropriateHeight() {
            if (window.innerWidth <= 768) {
                const viewportHeight = window.innerHeight;
                const navHeight = nav.offsetHeight;
                navLinks.style.maxHeight = `${viewportHeight - navHeight}px`;
                navLinks.style.overflowY = "auto";
            } else {
                navLinks.style.maxHeight = "";
                navLinks.style.overflowY = "";
            }
        }

        menuToggle.addEventListener("click", (event) => {
            event.stopPropagation();
            navLinks.classList.toggle("show");
            if (navLinks.classList.contains("show")) {
                setAppropriateHeight();
                closeDropdown();
                dropdownContainer.style.display = "none";
            }
        });

        libraryHandler.addEventListener("click", (event) => {
            event.stopPropagation();
            event.preventDefault();
            if (dropdownContainer.classList.contains("show")) {
                closeDropdown();
            } else {
                openDropdown();
            }
            setAppropriateHeight();
        });

        // Close all menus if a click is registered outside the navigation bar.
        document.addEventListener("click", (event) => {
            if (!nav.contains(event.target)) {
                navLinks.classList.remove("show");
                closeDropdown();
            }
        });

        // Hide navigation bar on scroll down in mobile view.
        window.addEventListener("scroll", () => {
            if (window.innerWidth <= 768) {
                if (window.scrollY > lastScrollY && window.scrollY > nav.offsetHeight){
                    nav.classList.add("hide");
                } else {
                    nav.classList.remove("hide");
                }
                lastScrollY = window.scrollY;
            }
        });

        window.addEventListener("resize", setAppropriateHeight);
    });
</script>
<!-- NAVBAR END -->


<div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Turing</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../">API</a></li><li><span class="tocitem">Submodule APIs</span><ul><li class="is-active"><a class="tocitem" href>Inference</a></li><li><a class="tocitem" href="../Optimisation/">Optimisation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Submodule APIs</a></li><li class="is-active"><a href>Inference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Inference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TuringLang/Turing.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/TuringLang/Turing.jl/blob/master/docs/src/api/Inference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API:-Turing.Inference"><a class="docs-heading-anchor" href="#API:-Turing.Inference">API: <code>Turing.Inference</code></a><a id="API:-Turing.Inference-1"></a><a class="docs-heading-anchor-permalink" href="#API:-Turing.Inference" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.CSMC" href="#Turing.Inference.CSMC"><code>Turing.Inference.CSMC</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CSMC(...)</code></pre><p>Equivalent to <a href="#Turing.Inference.PG"><code>PG</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/particle_mcmc.jl#L223-L227">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.ESS" href="#Turing.Inference.ESS"><code>Turing.Inference.ESS</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ESS</code></pre><p>Elliptical slice sampling algorithm.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; @model function gdemo(x)
           m ~ Normal()
           x ~ Normal(m, 0.5)
       end
gdemo (generic function with 2 methods)

julia&gt; sample(gdemo(1.0), ESS(), 1_000) |&gt; mean
Mean

│ Row │ parameters │ mean     │
│     │ Symbol     │ Float64  │
├─────┼────────────┼──────────┤
│ 1   │ m          │ 0.824853 │</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/ess.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.Emcee" href="#Turing.Inference.Emcee"><code>Turing.Inference.Emcee</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Emcee(n_walkers::Int, stretch_length=2.0)</code></pre><p>Affine-invariant ensemble sampling algorithm.</p><p><strong>Reference</strong></p><p>Foreman-Mackey, D., Hogg, D. W., Lang, D., &amp; Goodman, J. (2013). emcee: The MCMC Hammer. Publications of the Astronomical Society of the Pacific, 125 (925), 306. https://doi.org/10.1086/670067</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/emcee.jl#L5-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.ExternalSampler" href="#Turing.Inference.ExternalSampler"><code>Turing.Inference.ExternalSampler</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ExternalSampler{S&lt;:AbstractSampler,AD&lt;:ADTypes.AbstractADType,Unconstrained}</code></pre><p>Represents a sampler that is not an implementation of <code>InferenceAlgorithm</code>.</p><p>The <code>Unconstrained</code> type-parameter is to indicate whether the sampler requires unconstrained space.</p><p><strong>Fields</strong></p><ul><li><p><code>sampler::AbstractMCMC.AbstractSampler</code>: the sampler to wrap</p></li><li><p><code>adtype::ADTypes.AbstractADType</code>: the automatic differentiation (AD) backend to use</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/Inference.jl#L97-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.Gibbs" href="#Turing.Inference.Gibbs"><code>Turing.Inference.Gibbs</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Gibbs(algs...)</code></pre><p>Compositional MCMC interface. Gibbs sampling combines one or more sampling algorithms, each of which samples from a different set of variables in a model.</p><p>Example:</p><pre><code class="language-julia hljs">@model function gibbs_example(x)
    v1 ~ Normal(0,1)
    v2 ~ Categorical(5)
end

# Use PG for a &#39;v2&#39; variable, and use HMC for the &#39;v1&#39; variable.
# Note that v2 is discrete, so the PG sampler is more appropriate
# than is HMC.
alg = Gibbs(HMC(0.2, 3, :v1), PG(20, :v2))</code></pre><p>One can also pass the number of iterations for each Gibbs component using the following syntax:</p><ul><li><code>alg = Gibbs((HMC(0.2, 3, :v1), n_hmc), (PG(20, :v2), n_pg))</code></li></ul><p>where <code>n_hmc</code> and <code>n_pg</code> are the number of HMC and PG iterations for each Gibbs iteration.</p><p>Tips:</p><ul><li><code>HMC</code> and <code>NUTS</code> are fast samplers and can throw off particle-based</li></ul><p>methods like Particle Gibbs. You can increase the effectiveness of particle sampling by including more particles in the particle sampler.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/gibbs.jl#L20-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.GibbsConditional" href="#Turing.Inference.GibbsConditional"><code>Turing.Inference.GibbsConditional</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GibbsConditional(sym, conditional)</code></pre><p>A &quot;pseudo-sampler&quot; to manually provide analytical Gibbs conditionals to <code>Gibbs</code>. <code>GibbsConditional(:x, cond)</code> will sample the variable <code>x</code> according to the conditional <code>cond</code>, which must therefore be a function from a <code>NamedTuple</code> of the conditioned variables to a <code>Distribution</code>.</p><p>The <code>NamedTuple</code> that is passed in contains all random variables from the model in an unspecified order, taken from the <a href="https://turinglang.org/DynamicPPL.jl/stable/api/#DynamicPPL.VarInfo"><code>VarInfo</code></a> object over which the model is run. Scalars and vectors are stored in their respective shapes. The tuple also contains the value of the conditioned variable itself, which can be useful, but using it creates something that is not a Gibbs sampler anymore (see <a href="https://github.com/TuringLang/Turing.jl/pull/1275#discussion_r434240387">here</a>).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">α_0 = 2.0
θ_0 = inv(3.0)
x = [1.5, 2.0]
N = length(x)

@model function inverse_gdemo(x)
    λ ~ Gamma(α_0, θ_0)
    σ = sqrt(1 / λ)
    m ~ Normal(0, σ)
    @. x ~ $(Normal(m, σ))
end

# The conditionals can be formulated in terms of the following statistics:
x_bar = mean(x) # sample mean
s2 = var(x; mean=x_bar, corrected=false) # sample variance
m_n = N * x_bar / (N + 1)

function cond_m(c)
    λ_n = c.λ * (N + 1)
    σ_n = sqrt(1 / λ_n)
    return Normal(m_n, σ_n)
end

function cond_λ(c)
    α_n = α_0 + (N - 1) / 2 + 1
    β_n = s2 * N / 2 + c.m^2 / 2 + inv(θ_0)
    return Gamma(α_n, inv(β_n))
end

m = inverse_gdemo(x)

sample(m, Gibbs(GibbsConditional(:λ, cond_λ), GibbsConditional(:m, cond_m)), 10)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/gibbs_conditional.jl#L1-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.GibbsState" href="#Turing.Inference.GibbsState"><code>Turing.Inference.GibbsState</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GibbsState{V&lt;:VarInfo, S&lt;:Tuple{Vararg{Sampler}}}</code></pre><p>Stores a <code>VarInfo</code> for use in sampling, and a <code>Tuple</code> of <code>Samplers</code> that the <code>Gibbs</code> sampler iterates through for each <code>step!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/gibbs.jl#L78-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.HMC" href="#Turing.Inference.HMC"><code>Turing.Inference.HMC</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HMC(ϵ::Float64, n_leapfrog::Int; adtype::ADTypes.AbstractADType = AutoForwardDiff())</code></pre><p>Hamiltonian Monte Carlo sampler with static trajectory.</p><p><strong>Arguments</strong></p><ul><li><code>ϵ</code>: The leapfrog step size to use.</li><li><code>n_leapfrog</code>: The number of leapfrog steps to use.</li><li><code>adtype</code>: The automatic differentiation (AD) backend.   If not specified, <code>ForwardDiff</code> is used, with its <code>chunksize</code> automatically determined.</li></ul><p><strong>Usage</strong></p><pre><code class="language-julia hljs">HMC(0.05, 10)</code></pre><p><strong>Tips</strong></p><p>If you are receiving gradient errors when using <code>HMC</code>, try reducing the leapfrog step size <code>ϵ</code>, e.g.</p><pre><code class="language-julia hljs"># Original step size
sample(gdemo([1.5, 2]), HMC(0.1, 10), 1000)

# Reduced step size
sample(gdemo([1.5, 2]), HMC(0.01, 10), 1000)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/hmc.jl#L24-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.HMCDA" href="#Turing.Inference.HMCDA"><code>Turing.Inference.HMCDA</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HMCDA(
    n_adapts::Int, δ::Float64, λ::Float64; ϵ::Float64 = 0.0;
    adtype::ADTypes.AbstractADType = AutoForwardDiff(),
)</code></pre><p>Hamiltonian Monte Carlo sampler with Dual Averaging algorithm.</p><p><strong>Usage</strong></p><pre><code class="language-julia hljs">HMCDA(200, 0.65, 0.3)</code></pre><p><strong>Arguments</strong></p><ul><li><code>n_adapts</code>: Numbers of samples to use for adaptation.</li><li><code>δ</code>: Target acceptance rate. 65% is often recommended.</li><li><code>λ</code>: Target leapfrog length.</li><li><code>ϵ</code>: Initial step size; 0 means automatically search by Turing.</li><li><code>adtype</code>: The automatic differentiation (AD) backend.   If not specified, <code>ForwardDiff</code> is used, with its <code>chunksize</code> automatically determined.</li></ul><p><strong>Reference</strong></p><p>For more information, please view the following paper (<a href="https://arxiv.org/abs/1111.4246">arXiv link</a>):</p><p>Hoffman, Matthew D., and Andrew Gelman. &quot;The No-U-turn sampler: adaptively setting path lengths in Hamiltonian Monte Carlo.&quot; Journal of Machine Learning Research 15, no. 1 (2014): 1593-1623.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/hmc.jl#L297-L327">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.IS" href="#Turing.Inference.IS"><code>Turing.Inference.IS</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">IS()</code></pre><p>Importance sampling algorithm.</p><p>Usage:</p><pre><code class="language-julia hljs">IS()</code></pre><p>Example:</p><pre><code class="language-julia hljs"># Define a simple Normal model with unknown mean and variance.
@model function gdemo(x)
    s² ~ InverseGamma(2,3)
    m ~ Normal(0,sqrt.(s))
    x[1] ~ Normal(m, sqrt.(s))
    x[2] ~ Normal(m, sqrt.(s))
    return s², m
end

sample(gdemo([1.5, 2]), IS(), 1000)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/is.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.MH-Tuple" href="#Turing.Inference.MH-Tuple"><code>Turing.Inference.MH</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MH(space...)</code></pre><p>Construct a Metropolis-Hastings algorithm.</p><p>The arguments <code>space</code> can be</p><ul><li>Blank (i.e. <code>MH()</code>), in which case <code>MH</code> defaults to using the prior for each parameter as the proposal distribution.</li><li>A set of one or more symbols to sample with <code>MH</code> in conjunction with <code>Gibbs</code>, i.e. <code>Gibbs(MH(:m), PG(10, :s))</code></li><li>An iterable of pairs or tuples mapping a <code>Symbol</code> to a <code>AdvancedMH.Proposal</code>, <code>Distribution</code>, or <code>Function</code> that generates returns a conditional proposal distribution.</li><li>A covariance matrix to use as for mean-zero multivariate normal proposals.</li></ul><p><strong>Examples</strong></p><p>The default <code>MH</code> will draw proposal samples from the prior distribution using <code>AdvancedMH.StaticProposal</code>.</p><pre><code class="language-julia hljs">@model function gdemo(x, y)
    s² ~ InverseGamma(2,3)
    m ~ Normal(0, sqrt(s²))
    x ~ Normal(m, sqrt(s²))
    y ~ Normal(m, sqrt(s²))
end

chain = sample(gdemo(1.5, 2.0), MH(), 1_000)
mean(chain)</code></pre><p>Alternatively, you can specify particular parameters to sample if you want to combine sampling from multiple samplers:</p><pre><code class="language-julia hljs"># Samples s² with MH and m with PG
chain = sample(gdemo(1.5, 2.0), Gibbs(MH(:s²), PG(10, :m)), 1_000)
mean(chain)</code></pre><p>Specifying a single distribution implies the use of static MH:</p><pre><code class="language-julia hljs"># Use a static proposal for s² (which happens to be the same
# as the prior) and a static proposal for m (note that this 
# isn&#39;t a random walk proposal).
chain = sample(
    gdemo(1.5, 2.0),
    MH(
        :s² =&gt; InverseGamma(2, 3),
        :m =&gt; Normal(0, 1)
    ),
    1_000
)
mean(chain)</code></pre><p>Specifying explicit proposals using the <code>AdvancedMH</code> interface:</p><pre><code class="language-julia hljs"># Use a static proposal for s² and random walk with proposal
# standard deviation of 0.25 for m.
chain = sample(
    gdemo(1.5, 2.0),
    MH(
        :s² =&gt; AdvancedMH.StaticProposal(InverseGamma(2,3)),
        :m =&gt; AdvancedMH.RandomWalkProposal(Normal(0, 0.25))
    ),
    1_000
)
mean(chain)</code></pre><p>Using a custom function to specify a conditional distribution:</p><pre><code class="language-julia hljs"># Use a static proposal for s and and a conditional proposal for m,
# where the proposal is centered around the current sample.
chain = sample(
    gdemo(1.5, 2.0),
    MH(
        :s² =&gt; InverseGamma(2, 3),
        :m =&gt; x -&gt; Normal(x, 1)
    ),
    1_000
)
mean(chain)</code></pre><p>Providing a covariance matrix will cause <code>MH</code> to perform random-walk sampling in the transformed space with proposals drawn from a multivariate normal distribution. The provided matrix must be positive semi-definite and square:</p><pre><code class="language-julia hljs"># Providing a custom variance-covariance matrix
chain = sample(
    gdemo(1.5, 2.0),
    MH(
        [0.25 0.05;
         0.05 0.50]
    ),
    1_000
)
mean(chain)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/mh.jl#L15-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.MHLogDensityFunction" href="#Turing.Inference.MHLogDensityFunction"><code>Turing.Inference.MHLogDensityFunction</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MHLogDensityFunction</code></pre><p>A log density function for the MH sampler.</p><p>This variant uses the  <code>set_namedtuple!</code> function to update the <code>VarInfo</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/mh.jl#L200-L206">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.NUTS" href="#Turing.Inference.NUTS"><code>Turing.Inference.NUTS</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NUTS(n_adapts::Int, δ::Float64; max_depth::Int=10, Δ_max::Float64=1000.0, init_ϵ::Float64=0.0; adtype::ADTypes.AbstractADType=AutoForwardDiff()</code></pre><p>No-U-Turn Sampler (NUTS) sampler.</p><p>Usage:</p><pre><code class="language-julia hljs">NUTS()            # Use default NUTS configuration.
NUTS(1000, 0.65)  # Use 1000 adaption steps, and target accept ratio 0.65.</code></pre><p>Arguments:</p><ul><li><code>n_adapts::Int</code> : The number of samples to use with adaptation.</li><li><code>δ::Float64</code> : Target acceptance rate for dual averaging.</li><li><code>max_depth::Int</code> : Maximum doubling tree depth.</li><li><code>Δ_max::Float64</code> : Maximum divergence during doubling tree.</li><li><code>init_ϵ::Float64</code> : Initial step size; 0 means automatically searching using a heuristic procedure.</li><li><code>adtype::ADTypes.AbstractADType</code> : The automatic differentiation (AD) backend.   If not specified, <code>ForwardDiff</code> is used, with its <code>chunksize</code> automatically determined.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/hmc.jl#L374-L396">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.PG" href="#Turing.Inference.PG"><code>Turing.Inference.PG</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PG(n, space...)
PG(n, [resampler = AdvancedPS.ResampleWithESSThreshold(), space = ()])
PG(n, [resampler = AdvancedPS.resample_systematic, ]threshold[, space = ()])</code></pre><p>Create a Particle Gibbs sampler of type <a href="#Turing.Inference.PG"><code>PG</code></a> with <code>n</code> particles for the variables in <code>space</code>.</p><p>If the algorithm for the resampling step is not specified explicitly, systematic resampling is performed if the estimated effective sample size per particle drops below 0.5.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/particle_mcmc.jl#L192-L202">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.PG" href="#Turing.Inference.PG"><code>Turing.Inference.PG</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct PG{space, R} &lt;: Turing.Inference.ParticleInference</code></pre><p>Particle Gibbs sampler.</p><p><strong>Fields</strong></p><ul><li><p><code>nparticles::Int64</code>: Number of particles.</p></li><li><p><code>resampler::Any</code>: Resampling algorithm.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/particle_mcmc.jl#L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.PolynomialStepsize-Union{Tuple{T}, Tuple{T, T, T}} where T&lt;:Real" href="#Turing.Inference.PolynomialStepsize-Union{Tuple{T}, Tuple{T, T, T}} where T&lt;:Real"><code>Turing.Inference.PolynomialStepsize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PolynomialStepsize(a[, b=0, γ=0.55])</code></pre><p>Create a polynomially decaying stepsize function.</p><p>At iteration <code>t</code>, the step size is</p><p class="math-container">\[a (b + t)^{-γ}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/sghmc.jl#L147-L156">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.Prior" href="#Turing.Inference.Prior"><code>Turing.Inference.Prior</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Prior()</code></pre><p>Algorithm for sampling from the prior.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/Inference.jl#L199-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.SGHMC" href="#Turing.Inference.SGHMC"><code>Turing.Inference.SGHMC</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SGHMC{AD,space}</code></pre><p>Stochastic Gradient Hamiltonian Monte Carlo (SGHMC) sampler.e</p><p><strong>Fields</strong></p><ul><li><p><code>learning_rate::Real</code></p></li><li><p><code>momentum_decay::Real</code></p></li><li><p><code>adtype::Any</code></p></li></ul><p><strong>Reference</strong></p><p>Tianqi Chen, Emily Fox, &amp; Carlos Guestrin (2014). Stochastic Gradient Hamiltonian Monte Carlo. In: Proceedings of the 31st International Conference on Machine Learning (pp. 1683–1691).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/sghmc.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.SGHMC-Tuple{Vararg{Symbol}}" href="#Turing.Inference.SGHMC-Tuple{Vararg{Symbol}}"><code>Turing.Inference.SGHMC</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SGHMC(
    space::Symbol...;
    learning_rate::Real,
    momentum_decay::Real,
    adtype::ADTypes.AbstractADType = AutoForwardDiff(),
)</code></pre><p>Create a Stochastic Gradient Hamiltonian Monte Carlo (SGHMC) sampler.</p><p>If the automatic differentiation (AD) backend <code>adtype</code> is not provided, ForwardDiff with automatically determined <code>chunksize</code> is used.</p><p><strong>Reference</strong></p><p>Tianqi Chen, Emily Fox, &amp; Carlos Guestrin (2014). Stochastic Gradient Hamiltonian Monte Carlo. In: Proceedings of the 31st International Conference on Machine Learning (pp. 1683–1691).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/sghmc.jl#L21-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.SGLD" href="#Turing.Inference.SGLD"><code>Turing.Inference.SGLD</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SGLD</code></pre><p>Stochastic gradient Langevin dynamics (SGLD) sampler.</p><p><strong>Fields</strong></p><ul><li><p><code>stepsize::Any</code>: Step size function.</p></li><li><p><code>adtype::Any</code></p></li></ul><p><strong>Reference</strong></p><p>Max Welling &amp; Yee Whye Teh (2011). Bayesian Learning via Stochastic Gradient Langevin Dynamics. In: Proceedings of the 28th International Conference on Machine Learning (pp. 681–688).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/sghmc.jl#L113-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.SGLD-Tuple{Vararg{Symbol}}" href="#Turing.Inference.SGLD-Tuple{Vararg{Symbol}}"><code>Turing.Inference.SGLD</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SGLD(
    space::Symbol...;
    stepsize = PolynomialStepsize(0.01),
    adtype::ADTypes.AbstractADType = AutoForwardDiff(),
)</code></pre><p>Stochastic gradient Langevin dynamics (SGLD) sampler.</p><p>By default, a polynomially decaying stepsize is used.</p><p>If the automatic differentiation (AD) backend <code>adtype</code> is not provided, ForwardDiff with automatically determined <code>chunksize</code> is used.</p><p><strong>Reference</strong></p><p>Max Welling &amp; Yee Whye Teh (2011). Bayesian Learning via Stochastic Gradient Langevin Dynamics. In: Proceedings of the 28th International Conference on Machine Learning (pp. 681–688).</p><p>See also: <a href="#Turing.Inference.PolynomialStepsize-Union{Tuple{T}, Tuple{T, T, T}} where T&lt;:Real"><code>PolynomialStepsize</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/sghmc.jl#L166-L187">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.SMC" href="#Turing.Inference.SMC"><code>Turing.Inference.SMC</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SMC(space...)
SMC([resampler = AdvancedPS.ResampleWithESSThreshold(), space = ()])
SMC([resampler = AdvancedPS.resample_systematic, ]threshold[, space = ()])</code></pre><p>Create a sequential Monte Carlo sampler of type <a href="#Turing.Inference.SMC"><code>SMC</code></a> for the variables in <code>space</code>.</p><p>If the algorithm for the resampling step is not specified explicitly, systematic resampling is performed if the estimated effective sample size per particle drops below 0.5.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/particle_mcmc.jl#L22-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.SMC" href="#Turing.Inference.SMC"><code>Turing.Inference.SMC</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SMC{space, R} &lt;: Turing.Inference.ParticleInference</code></pre><p>Sequential Monte Carlo sampler.</p><p><strong>Fields</strong></p><ul><li><code>resampler::Any</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/particle_mcmc.jl#L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StatsAPI.predict-Tuple{DynamicPPL.Model, Chains}" href="#StatsAPI.predict-Tuple{DynamicPPL.Model, Chains}"><code>StatsAPI.predict</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">predict([rng::AbstractRNG,] model::Model, chain::MCMCChains.Chains; include_all=false)</code></pre><p>Execute <code>model</code> conditioned on each sample in <code>chain</code>, and return the resulting <code>Chains</code>.</p><p>If <code>include_all</code> is <code>false</code>, the returned <code>Chains</code> will contain only those variables sampled/not present in <code>chain</code>.</p><p><strong>Details</strong></p><p>Internally calls <code>Turing.Inference.transitions_from_chain</code> to obtained the samples and then converts these into a <code>Chains</code> object using <code>AbstractMCMC.bundle_samples</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Turing; Turing.setprogress!(false);
[ Info: [Turing]: progress logging is disabled globally

julia&gt; @model function linear_reg(x, y, σ = 0.1)
           β ~ Normal(0, 1)

           for i ∈ eachindex(y)
               y[i] ~ Normal(β * x[i], σ)
           end
       end;

julia&gt; σ = 0.1; f(x) = 2 * x + 0.1 * randn();

julia&gt; Δ = 0.1; xs_train = 0:Δ:10; ys_train = f.(xs_train);

julia&gt; xs_test = [10 + Δ, 10 + 2 * Δ]; ys_test = f.(xs_test);

julia&gt; m_train = linear_reg(xs_train, ys_train, σ);

julia&gt; chain_lin_reg = sample(m_train, NUTS(100, 0.65), 200);
┌ Info: Found initial step size
└   ϵ = 0.003125

julia&gt; m_test = linear_reg(xs_test, Vector{Union{Missing, Float64}}(undef, length(ys_test)), σ);

julia&gt; predictions = predict(m_test, chain_lin_reg)
Object of type Chains, with data of type 100×2×1 Array{Float64,3}

Iterations        = 1:100
Thinning interval = 1
Chains            = 1
Samples per chain = 100
parameters        = y[1], y[2]

2-element Array{ChainDataFrame,1}

Summary Statistics
  parameters     mean     std  naive_se     mcse       ess   r_hat
  ──────────  ───────  ──────  ────────  ───────  ────────  ──────
        y[1]  20.1974  0.1007    0.0101  missing  101.0711  0.9922
        y[2]  20.3867  0.1062    0.0106  missing  101.4889  0.9903

Quantiles
  parameters     2.5%    25.0%    50.0%    75.0%    97.5%
  ──────────  ───────  ───────  ───────  ───────  ───────
        y[1]  20.0342  20.1188  20.2135  20.2588  20.4188
        y[2]  20.1870  20.3178  20.3839  20.4466  20.5895

julia&gt; ys_pred = vec(mean(Array(group(predictions, :y)); dims = 1));

julia&gt; sum(abs2, ys_test - ys_pred) ≤ 0.1
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/Inference.jl#L600-L669">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.dist_val_tuple-Tuple{DynamicPPL.Sampler{&lt;:MH}, Union{DynamicPPL.ThreadSafeVarInfo{&lt;:DynamicPPL.VarInfo{Tmeta}}, DynamicPPL.VarInfo{Tmeta}} where Tmeta}" href="#Turing.Inference.dist_val_tuple-Tuple{DynamicPPL.Sampler{&lt;:MH}, Union{DynamicPPL.ThreadSafeVarInfo{&lt;:DynamicPPL.VarInfo{Tmeta}}, DynamicPPL.VarInfo{Tmeta}} where Tmeta}"><code>Turing.Inference.dist_val_tuple</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dist_val_tuple(spl::Sampler{&lt;:MH}, vi::VarInfo)</code></pre><p>Return two <code>NamedTuples</code>.</p><p>The first <code>NamedTuple</code> has symbols as keys and distributions as values. The second <code>NamedTuple</code> has model symbols as keys and their stored values as values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/mh.jl#L247-L254">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.externalsampler-Tuple{AbstractMCMC.AbstractSampler}" href="#Turing.Inference.externalsampler-Tuple{AbstractMCMC.AbstractSampler}"><code>Turing.Inference.externalsampler</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">externalsampler(sampler::AbstractSampler; adtype=AutoForwardDiff(), unconstrained=true)</code></pre><p>Wrap a sampler so it can be used as an inference algorithm.</p><p><strong>Arguments</strong></p><ul><li><code>sampler::AbstractSampler</code>: The sampler to wrap.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>adtype::ADTypes.AbstractADType=ADTypes.AutoForwardDiff()</code>: The automatic differentiation (AD) backend to use.</li><li><code>unconstrained::Bool=true</code>: Whether the sampler requires unconstrained space.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/Inference.jl#L149-L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.getparams-Tuple{Any, Any}" href="#Turing.Inference.getparams-Tuple{Any, Any}"><code>Turing.Inference.getparams</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getparams(model, t)</code></pre><p>Return a named tuple of parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/Inference.jl#L368-L372">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.gibbs_rerun-Tuple{Any, Any}" href="#Turing.Inference.gibbs_rerun-Tuple{Any, Any}"><code>Turing.Inference.gibbs_rerun</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gibbs_rerun(prev_alg, alg)</code></pre><p>Check if the model should be rerun to recompute the log density before sampling with the Gibbs component <code>alg</code> and after sampling from Gibbs component <code>prev_alg</code>.</p><p>By default, the function returns <code>true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/gibbs.jl#L132-L139">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.gibbs_state-Tuple{Any, Any, DynamicPPL.AbstractVarInfo, DynamicPPL.AbstractVarInfo}" href="#Turing.Inference.gibbs_state-Tuple{Any, Any, DynamicPPL.AbstractVarInfo, DynamicPPL.AbstractVarInfo}"><code>Turing.Inference.gibbs_state</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gibbs_state(model, sampler, state, varinfo)</code></pre><p>Return an updated state, taking into account the variables sampled by other Gibbs components.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: model targeted by the Gibbs sampler.</li><li><code>sampler</code>: the sampler for this Gibbs component.</li><li><code>state</code>: the state of <code>sampler</code> computed in the previous iteration.</li><li><code>varinfo</code>: the variables, including the ones sampled by other Gibbs components.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/gibbs.jl#L100-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.gibbs_varinfo-Tuple{Any, Any, Any}" href="#Turing.Inference.gibbs_varinfo-Tuple{Any, Any, Any}"><code>Turing.Inference.gibbs_varinfo</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gibbs_varinfo(model, sampler, state)</code></pre><p>Return the variables corresponding to the current <code>state</code> of the Gibbs component <code>sampler</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/gibbs.jl#L91-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.group_varnames_by_symbol-Tuple{Any}" href="#Turing.Inference.group_varnames_by_symbol-Tuple{Any}"><code>Turing.Inference.group_varnames_by_symbol</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">group_varnames_by_symbol(vns)</code></pre><p>Group the varnames by their symbol.</p><p><strong>Arguments</strong></p><ul><li><code>vns</code>: Iterable of <code>VarName</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>OrderedDict{Symbol, Vector{VarName}}</code>: A dictionary mapping symbol to a vector of varnames.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/Inference.jl#L533-L543">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.isgibbscomponent-Tuple{Any}" href="#Turing.Inference.isgibbscomponent-Tuple{Any}"><code>Turing.Inference.isgibbscomponent</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isgibbscomponent(alg)</code></pre><p>Determine whether algorithm <code>alg</code> is allowed as a Gibbs component.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/gibbs.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.mh_accept-Tuple{Real, Real, Real}" href="#Turing.Inference.mh_accept-Tuple{Real, Real, Real}"><code>Turing.Inference.mh_accept</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mh_accept(logp_current::Real, logp_proposal::Real, log_proposal_ratio::Real)</code></pre><p>Decide if a proposal <span>$x&#39;$</span> with log probability <span>$\log p(x&#39;) = logp_proposal$</span> and log proposal ratio <span>$\log k(x&#39;, x) - \log k(x, x&#39;) = log_proposal_ratio$</span> in a Metropolis-Hastings algorithm with Markov kernel <span>$k(x_t, x_{t+1})$</span> and current state <span>$x$</span> with log probability <span>$\log p(x) = logp_current$</span> is accepted by evaluating the Metropolis-Hastings acceptance criterion</p><p class="math-container">\[\log U \leq \log p(x&#39;) - \log p(x) + \log k(x&#39;, x) - \log k(x, x&#39;)\]</p><p>for a uniform random number <span>$U \in [0, 1)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/Inference.jl#L223-L235">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.recompute_logprob!!-Tuple{Random.AbstractRNG, DynamicPPL.Model, DynamicPPL.Sampler{&lt;:Turing.Inference.ExternalSampler}, Any}" href="#Turing.Inference.recompute_logprob!!-Tuple{Random.AbstractRNG, DynamicPPL.Model, DynamicPPL.Sampler{&lt;:Turing.Inference.ExternalSampler}, Any}"><code>Turing.Inference.recompute_logprob!!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">recompute_logprob!!(rng, model, sampler, state)</code></pre><p>Recompute the log-probability of the <code>model</code> based on the given <code>state</code> and return the resulting state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/abstractmcmc.jl#L56-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.requires_unconstrained_space-Union{Tuple{Turing.Inference.ExternalSampler{&lt;:Any, &lt;:Any, Unconstrained}}, Tuple{Unconstrained}} where Unconstrained" href="#Turing.Inference.requires_unconstrained_space-Union{Tuple{Turing.Inference.ExternalSampler{&lt;:Any, &lt;:Any, Unconstrained}}, Tuple{Unconstrained}} where Unconstrained"><code>Turing.Inference.requires_unconstrained_space</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">requires_unconstrained_space(sampler::ExternalSampler)</code></pre><p>Return <code>true</code> if the sampler requires unconstrained space, and <code>false</code> otherwise.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/Inference.jl#L140-L144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.set_namedtuple!-Tuple{Union{DynamicPPL.ThreadSafeVarInfo{&lt;:DynamicPPL.VarInfo{Tmeta}}, DynamicPPL.VarInfo{Tmeta}} where Tmeta, NamedTuple}" href="#Turing.Inference.set_namedtuple!-Tuple{Union{DynamicPPL.ThreadSafeVarInfo{&lt;:DynamicPPL.VarInfo{Tmeta}}, DynamicPPL.VarInfo{Tmeta}} where Tmeta, NamedTuple}"><code>Turing.Inference.set_namedtuple!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_namedtuple!(vi::VarInfo, nt::NamedTuple)</code></pre><p>Places the values of a <code>NamedTuple</code> into the relevant places of a <code>VarInfo</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/mh.jl#L176-L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Turing.Inference.transitions_from_chain-Tuple{DynamicPPL.Model, Chains}" href="#Turing.Inference.transitions_from_chain-Tuple{DynamicPPL.Model, Chains}"><code>Turing.Inference.transitions_from_chain</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transitions_from_chain(
    [rng::AbstractRNG,]
    model::Model,
    chain::MCMCChains.Chains;
    sampler = DynamicPPL.SampleFromPrior()
)</code></pre><p>Execute <code>model</code> conditioned on each sample in <code>chain</code>, and return resulting transitions.</p><p>The returned transitions are represented in a <code>Vector{&lt;:Turing.Inference.Transition}</code>.</p><p><strong>Details</strong></p><p>In a bit more detail, the process is as follows:</p><ol><li>For every <code>sample</code> in <code>chain</code><ol><li>For every <code>variable</code> in <code>sample</code><ol><li>Set <code>variable</code> in <code>model</code> to its value in <code>sample</code></li></ol></li><li>Execute <code>model</code> with variables fixed as above, sampling variables NOT present in <code>chain</code> using <code>SampleFromPrior</code></li><li>Return sampled variables and log-joint</li></ol></li></ol><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Turing

julia&gt; @model function demo()
           m ~ Normal(0, 1)
           x ~ Normal(m, 1)
       end;

julia&gt; m = demo();

julia&gt; chain = Chains(randn(2, 1, 1), [&quot;m&quot;]); # 2 samples of `m`

julia&gt; transitions = Turing.Inference.transitions_from_chain(m, chain);

julia&gt; [Turing.Inference.getlogp(t) for t in transitions] # extract the logjoints
2-element Array{Float64,1}:
 -3.6294991938628374
 -2.5697948166987845

julia&gt; [first(t.θ.x) for t in transitions] # extract samples for `x`
2-element Array{Array{Float64,1},1}:
 [-2.0844148956440796]
 [-1.704630494695469]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/Turing.jl/blob/f388e61d6820af0ce6c14ab48fd9edb98e39e706/src/mcmc/Inference.jl#L706-L754">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« API</a><a class="docs-footer-nextpage" href="../Optimisation/">Optimisation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 23 October 2024 21:51">Wednesday 23 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

